# @package _global_
defaults:
  - /base/logging_config@_here_
  - /base/exp_config@_here_

exp_config:
#  name: test
#  experiment: test
  name: original_reprover
  experiment: random_train
  resume: true
  directory: experiments/runs/random_train/original_reprover_2023_12_21/17_20_53

logging_config:
  project: end_to_end
  offline: false
  id: el4a0qft

env: leandojo
data_path: data/leandojo/data/leandojo_benchmark/random/
split: train
#split: test
file_path: null
full_name: null
num_theorems: 94000 #2000
#num_theorems: 2
shuffle: false
name_filter: null
name: null
indexed_corpus_path: null
num_sampled_tactics: 64
total_timeout: 6000
env_timeout: 200
with_gpus: true
log_level: 'INFO'
logical_gpus: 4
num_gpus: 2
num_cpus: 8
gpu_per_prover: 0.01
cpu_per_prover: 1
provers_per_gpu: 1

num_iterations: 1
resume_iteration: 0

tac_model:
  model: reprover
  ckpt_path: last.ckpt
  distributed: true
  gpu_per_process: 0.45
  cpu_per_process: 1
  config:
    model_name: kaiyuy/leandojo-lean3-tacgen-byt5-small
    lr: 5e-6
    warmup_steps: 200
    length_penalty: 0.0
    num_beams: 64
    ret_ckpt_path: null
    max_seq_len: 2300
    gen_config:
      strategy: beam
      length_penalty: 0.0
    eval_config: null

search_model:
  search: bestfs
  #    search: htps
  #    ckpt_path: goal_model.ckpt # goal_step.ckpt
  #    distributed: true
  #    gpu_per_process: 0.45
  #    cpu_per_process: 0.5
  #    exploration_constant: 1

  #  search: updown
  #  ckpt_path: goal_model.ckpt
  #  distributed: true
  #  gpu_per_process: 0.45 #0.225
  #  cpu_per_process: 1 # 0.5

#train_after_eval:
#  - python3 -m refactor.lightning_experiment --config-name=goal_model/run data_module.trace_files=${exp_config.directory}/traces
#  - python3 -m refactor.lightning_experiment --config-name=tac_gen/run data_module.trace_files=${exp_config.directory}/traces
